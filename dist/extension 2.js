"use strict";const e=require("vscode"),t=require("fs"),n={...l("/../data/SallaJson/salla.snippets.autogenerated.json"),...l("/../data/SallaJson/hover/salla.filters.json"),...l("/../data/SallaJson/hover/salla.functions.json"),...l("/../data/Twig/snippets/snippets.json"),...l("/../data/Twig/hover/filters.json")},o=l("/../data/Twig/hover/functions.json"),i=l("/../data/Twig/hover/twig.json"),r="https://docs.salla.dev/",s=l("/../data/SallaJson/hooks.json"),a=e.workspace.getConfiguration("@salla.sa/twig-theme-one");function l(e){let n=t.readFileSync(__dirname+e,"utf8");return JSON.parse(n)}function p(t,n){let o=void 0===t.example?"":t.example,i=void 0===t.description?"":t.description;return new e.Hover({language:n||"html",value:i+"\n\n"+o})}function u(t,n){let o=function(e){let t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(n);return t}(n);if("global"===t)return function(t){return t.map((t=>{const n=new e.CompletionItem(t);return n.insertText=new e.SnippetString(t),n.label=t,n}))}(o);const i=new e.CompletionItem(" "+t);i.insertText=new e.SnippetString(t+".${1|"+o+"|}");const s=new e.MarkdownString("Select your Salla Ojbect Property from the list below");return i.kind=e.CompletionItemKind.Property,i.label="Salla "+t,i.documentation=s,s.baseUri=e.Uri.parse(r),[i]}exports.activate=function(d){const m=e.window.activeTextEditor;m&&m.document&&function(m){!0===a.hover&&d.subscriptions.push(e.languages.registerHoverProvider(m,{provideHover(e,t){const r=e.getWordRangeAtPosition(t),s=e.getText(r);for(const e in n)if(n[e].prefix==s||n[e].hover==s)return p(n[e],m);for(const e in o)if(o[e].prefix==s||o[e].hover==s)return p(o[e],m);for(const e in i)if(i[e].prefix==s||i[e].hover==s)return p(i[e],m)}}));d.subscriptions.push(e.languages.registerCompletionItemProvider("html",{provideCompletionItems(t,o){let i=new e.Position(o.line,0),r=new e.Range(i,o),s=t.getText(r),a=[];if("|"!=s[s.length-1])return[];for(let t in n)if(void 0!==n[t].text){let o=void 0===n[t].description?"":n[t].description,i=void 0===n[t].example?"":"\n\n"+n[t].example,r=new e.CompletionItem(t);r.kind=e.CompletionItemKind.Function,r.detail=n[t].description,r.documentation=o+i,r.insertText=n[t].text,a.push(r)}return a},resolveCompletionItem:e=>e},"|")),d.subscriptions.push(e.languages.registerCompletionItemProvider(m,{provideCompletionItems(){let t=l("/../data/SallaJson/components.json");const n=new e.CompletionItem("{% component [Salla.Component] %}");n.insertText=new e.SnippetString("{% component '${1|"+t+"|}' %}");const o=new e.MarkdownString("Select your Salla Component from the list below");return n.documentation=o,o.baseUri=e.Uri.parse(r),[n]}})),d.subscriptions.push(e.languages.registerCompletionItemProvider(m,{provideCompletionItems(){const t=new e.CompletionItem("{% hook '[Salla.Hook]' %}");t.insertText=new e.SnippetString("{% hook '${1|"+s+"|}' %}");const n=new e.MarkdownString("Select your Salla Hook from the list below");return t.documentation=n,n.baseUri=e.Uri.parse(r),[t]}})),d.subscriptions.push(e.languages.registerCompletionItemProvider(m,{provideCompletionItems(){let e=[],n=t.readdirSync(__dirname+"/../data/SallaJson/modals.twig/");for(let t=0;t<n.length;t++)e.push(...u(n[t].replace(".json",""),l("/../data/SallaJson/modals.twig/"+n[t])));return[...e]}}))}("html")},exports.deactivate=function(){};
